<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IB SEHS Predictor | Antigravity</title>
    
    <!-- 1. Tailwind CSS (Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React & ReactDOM (Core Logic) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- 3. Babel (Enables React code in browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 4. Antigravity Theme Styles -->
    <style>
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(2deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }
        @keyframes drift {
            0% { transform: translateX(0px); opacity: 0.3; }
            50% { transform: translateX(30px); opacity: 0.6; }
            100% { transform: translateX(0px); opacity: 0.3; }
        }
        .animate-float { animation: float 6s ease-in-out infinite; }
        .animate-drift { animation: drift 10s ease-in-out infinite; }
        
        .glass-panel {
            background: rgba(13, 17, 23, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(48, 54, 61, 0.6);
        }
        
        .glass-card {
            background: rgba(22, 27, 34, 0.6);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(48, 54, 61, 0.5);
            transition: all 0.3s ease;
        }
        
        .glass-card:hover {
            transform: translateY(-2px);
            background: rgba(22, 27, 34, 0.8);
            border-color: rgba(88, 166, 255, 0.4);
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
        }

        /* Custom Scrollbar */
        textarea::-webkit-scrollbar { width: 8px; }
        textarea::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
        textarea::-webkit-scrollbar-thumb { background: #30363d; border-radius: 4px; }
        textarea::-webkit-scrollbar-thumb:hover { background: #58a6ff; }
    </style>
</head>
<body class="bg-[#0d1117] text-[#c9d1d9] min-h-screen">

    <!-- React App Mount Point -->
    <div id="root"></div>

    <!-- 5. Application Logic -->
    <script type="text/babel">
        const { useState } = React;

        // --- ICON COMPONENTS (SVG) ---
        // Simplified icons embedded directly to avoid external dependencies
        const Icons = {
            BarChart2: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>,
            Download: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>,
            ChevronDown: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>,
            ChevronUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>,
            User: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>,
            Mail: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>,
            CheckSquare: () => <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg>,
            FileText: () => <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
        };

        // --- DATA ---
        const SEHS_DATA = [
            { code: 'A.1.1', title: 'Inter-system communication', sl: 10, hl: 0 },
            { code: 'A.1.1.2', title: 'Endocrine system (Reproductive)', sl: 1, hl: 0 },
            { code: 'A.1.2', title: 'Maintaining homeostasis', sl: 6, hl: 0 },
            { code: 'A.1.2.2', title: 'Body response to environment (AHL)', sl: 0, hl: 5 },
            { code: 'A.1.3', title: 'Transport', sl: 7, hl: 0 },
            { code: 'A.2.1', title: 'Water and electrolyte balance', sl: 3, hl: 0 },
            { code: 'A.2.2', title: 'Fuelling for health/performance', sl: 6, hl: 4 },
            { code: 'A.2.3', title: 'Energy systems', sl: 7, hl: 2 },
            { code: 'A.3.1', title: 'Qualities of training', sl: 6, hl: 0 },
            { code: 'A.3.2', title: 'Benefits to health of being active', sl: 2, hl: 2 },
            { code: 'A.3.3', title: 'Fatigue and recovery (AHL)', sl: 0, hl: 9 },
            { code: 'B.1.1', title: 'Anatomical position/planes', sl: 3, hl: 3 },
            { code: 'B.1.2', title: 'Structure connective tissues', sl: 3, hl: 0 },
            { code: 'B.1.3', title: 'Muscular function', sl: 4, hl: 2 },
            { code: 'B.1.4', title: 'Levers in movement', sl: 2, hl: 0 },
            { code: 'B.2.1', title: 'Newton’s laws of motion', sl: 5, hl: 12 },
            { code: 'B.2.2', title: 'Fluid mechanics', sl: 3, hl: 8 },
            { code: 'B.2.3', title: 'Movement analysis', sl: 3, hl: 0 },
            { code: 'B.3', title: 'Injury', sl: 7, hl: 2 },
            { code: 'C.1', title: 'Individual differences', sl: 4, hl: 6 },
            { code: 'C.2.1', title: 'Motor learning processes', sl: 10, hl: 0 },
            { code: 'C.2.2', title: 'Attentional control', sl: 2, hl: 0 },
            { code: 'C.3', title: 'Motivation', sl: 8, hl: 8 },
            { code: 'C.4.1', title: 'Arousal and anxiety', sl: 3, hl: 0 },
            { code: 'C.4.2', title: 'Coping', sl: 2, hl: 2 },
            { code: 'C.5', title: 'Psychological skills', sl: 4, hl: 5 },
        ];

        // --- COMPONENTS ---

        const PaperBlock = ({ title, level, paper, data, onChange, themeColor }) => {
            const getVal = (field) => data?.[level]?.[paper]?.[field] || '';
            
            const borderFocus = themeColor === 'cyan' ? 'focus:border-cyan-400 focus:shadow-[0_0_10px_rgba(34,211,238,0.1)]' : 'focus:border-purple-400 focus:shadow-[0_0_10px_rgba(192,132,252,0.1)]';
            const textTheme = themeColor === 'cyan' ? 'text-cyan-400' : 'text-purple-400';
            const tildeColor = themeColor === 'cyan' ? 'text-cyan-500' : 'text-purple-500';

            return (
                <div className="bg-[#0d1117] rounded-md p-3 border border-[#30363d] mb-3 last:mb-0 hover:border-[#8b949e] transition-colors group">
                    <h4 className={`text-xs font-mono font-bold uppercase tracking-wider mb-3 ${textTheme} flex items-center gap-2 border-b border-[#30363d] pb-2 group-hover:border-[#8b949e] transition-colors`}>
                        <Icons.FileText /> {title}
                    </h4>
                    
                    <div className="space-y-3">
                        <div>
                            <label className="flex items-center gap-2 text-[10px] uppercase text-[#8b949e] mb-1 font-semibold">
                                <span className={`text-lg font-serif ${tildeColor} leading-none`}>~</span> 
                                Predicted Points
                            </label>
                            <input 
                                type="number" 
                                className={`w-full bg-[#161b22] border border-[#30363d] rounded px-2 py-1.5 text-[#c9d1d9] text-sm ${borderFocus} focus:outline-none transition-all duration-300 font-mono`}
                                placeholder="0"
                                value={getVal('points')}
                                onChange={(e) => onChange(level, paper, 'points', e.target.value)}
                            />
                        </div>

                        <div>
                            <label className="block text-[10px] uppercase text-[#8b949e] mb-1">Draft Question</label>
                            <textarea 
                                className={`w-full bg-[#161b22] border border-[#30363d] rounded px-2 py-1.5 text-[#c9d1d9] text-sm h-16 ${borderFocus} focus:outline-none transition-all duration-300 resize-none font-sans`}
                                placeholder="Type your question..."
                                value={getVal('question')}
                                onChange={(e) => onChange(level, paper, 'question', e.target.value)}
                            />
                        </div>

                        <div>
                            <label className="block text-[10px] uppercase text-[#8b949e] mb-1">Mark Scheme</label>
                            <textarea 
                                className={`w-full bg-[#161b22] border border-[#30363d] rounded px-2 py-1.5 text-[#c9d1d9] text-sm h-16 ${borderFocus} focus:outline-none transition-all duration-300 resize-none font-sans`}
                                placeholder="Key marking points..."
                                value={getVal('markscheme')}
                                onChange={(e) => onChange(level, paper, 'markscheme', e.target.value)}
                            />
                        </div>
                    </div>
                </div>
            );
        };

        const UnitRow = ({ unit, data, onChange, isExpanded, onToggle }) => {
            return (
                <div className={`mb-4 border rounded-lg overflow-hidden transition-all duration-300 backdrop-blur-sm ${isExpanded ? 'border-[#58a6ff] bg-[#161b22]/90 shadow-lg' : 'border-[#30363d] bg-[#161b22]/50 hover:border-[#8b949e]'}`}>
                    <div 
                        className="flex items-center justify-between p-4 cursor-pointer hover:bg-[#21262d] transition-colors"
                        onClick={onToggle}
                    >
                        <div className="flex items-center gap-4 flex-1">
                            <div className="flex items-center gap-2">
                                <div className={`w-2 h-2 rounded-full ${isExpanded ? 'bg-[#58a6ff] animate-pulse' : 'bg-[#30363d]'}`}></div>
                                <div className="w-16 font-mono font-bold text-[#58a6ff]">{unit.code}</div>
                            </div>
                            <div className="font-medium text-[#c9d1d9] flex-1">{unit.title}</div>
                            
                            <div className="flex gap-3 text-sm mr-4 items-center hidden sm:flex">
                                <div className="flex flex-col items-center px-3 py-1 bg-[#0d1117] rounded border border-[#30363d]">
                                    <span className="text-[10px] text-[#8b949e] uppercase">Hist. SL</span>
                                    <span className="text-[#c9d1d9] font-bold font-mono">{unit.sl}</span>
                                </div>
                                <div className="flex flex-col items-center px-3 py-1 bg-[#0d1117] rounded border border-[#30363d]">
                                    <span className="text-[10px] text-[#8b949e] uppercase">Hist. HL</span>
                                    <span className="text-[#c9d1d9] font-bold font-mono">{unit.hl}</span>
                                </div>
                            </div>
                        </div>
                        
                        {isExpanded ? <Icons.ChevronUp /> : <Icons.ChevronDown />}
                    </div>

                    {isExpanded && (
                        <div className="p-4 bg-[#0d1117]/50 border-t border-[#30363d] grid grid-cols-1 lg:grid-cols-2 gap-6 relative">
                            <div className="absolute left-1/2 top-0 bottom-0 w-px bg-[#30363d] hidden lg:block"></div>
                            
                            {/* SL Column */}
                            <div className="glass-card p-4 rounded-lg relative overflow-hidden">
                                <div className="absolute top-0 left-0 w-1 h-full bg-cyan-500/50"></div>
                                <div className="flex items-center justify-between mb-4 border-b border-[#30363d] pb-2">
                                    <h3 className="font-bold text-cyan-400 flex items-center gap-2 font-mono">
                                        Standard Level (SL)
                                    </h3>
                                </div>
                                
                                <PaperBlock title="Paper 1A" level="sl" paper="p1a" data={data} onChange={(l, p, f, v) => onChange(unit.code, l, p, f, v)} themeColor="cyan" />
                                <PaperBlock title="Paper 2" level="sl" paper="p2" data={data} onChange={(l, p, f, v) => onChange(unit.code, l, p, f, v)} themeColor="cyan" />
                            </div>

                            {/* HL Column */}
                            <div className="glass-card p-4 rounded-lg relative overflow-hidden">
                                <div className="absolute top-0 left-0 w-1 h-full bg-purple-500/50"></div>
                                <div className="flex items-center justify-between mb-4 border-b border-[#30363d] pb-2">
                                    <h3 className="font-bold text-purple-400 flex items-center gap-2 font-mono">
                                        Higher Level (HL)
                                    </h3>
                                </div>

                                <PaperBlock title="Paper 1A" level="hl" paper="p1a" data={data} onChange={(l, p, f, v) => onChange(unit.code, l, p, f, v)} themeColor="purple" />
                                <PaperBlock title="Paper 2" level="hl" paper="p2" data={data} onChange={(l, p, f, v) => onChange(unit.code, l, p, f, v)} themeColor="purple" />
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const App = () => {
            const [userInfo, setUserInfo] = useState({ email: '', username: '' });
            const [formData, setFormData] = useState({});
            const [expandedRow, setExpandedRow] = useState(null); 

            const handleUserChange = (field, value) => {
                setUserInfo(prev => ({ ...prev, [field]: value }));
            };

            const handleUnitChange = (unitCode, level, paper, field, value) => {
                setFormData(prev => ({
                    ...prev,
                    [unitCode]: {
                        ...prev[unitCode],
                        [level]: {
                            ...prev[unitCode]?.[level],
                            [paper]: {
                                ...prev[unitCode]?.[level]?.[paper],
                                [field]: value
                            }
                        }
                    }
                }));
            };

            const toggleRow = (code) => {
                setExpandedRow(prev => prev === code ? null : code);
            };

            const handleExport = () => {
                const exportData = {
                    user: userInfo,
                    predictions: formData,
                    timestamp: new Date().toISOString()
                };
                
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(exportData, null, 2));
                const downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", `IB_SEHS_Prediction_${userInfo.username || 'Student'}.json`);
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
            };

            const calculateTotalPredicted = () => {
                let slTotal = 0;
                let hlTotal = 0;
                
                Object.values(formData).forEach(unit => {
                    if(unit.sl) {
                        if (unit.sl.p1a?.points) slTotal += parseInt(unit.sl.p1a.points) || 0;
                        if (unit.sl.p2?.points) slTotal += parseInt(unit.sl.p2.points) || 0;
                    }
                    if(unit.hl) {
                        if (unit.hl.p1a?.points) hlTotal += parseInt(unit.hl.p1a.points) || 0;
                        if (unit.hl.p2?.points) hlTotal += parseInt(unit.hl.p2.points) || 0;
                    }
                });
                return { slTotal, hlTotal };
            };

            const stats = calculateTotalPredicted();

            return (
                <div className="relative min-h-screen font-sans bg-[#0d1117]">
                    
                    {/* Background Animation */}
                    <div className="fixed inset-0 pointer-events-none overflow-hidden z-0">
                        <div className="absolute top-20 left-10 w-64 h-64 bg-purple-600/10 rounded-full blur-[80px] animate-float"></div>
                        <div className="absolute bottom-20 right-10 w-96 h-96 bg-blue-600/10 rounded-full blur-[100px] animate-drift"></div>
                        <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-indigo-900/5 rounded-full blur-[120px]"></div>
                        
                        {/* Particles */}
                        <div className="absolute top-1/4 left-1/4 w-2 h-2 bg-white/20 rounded-full animate-float"></div>
                        <div className="absolute top-3/4 left-1/3 w-1 h-1 bg-white/30 rounded-full animate-float" style={{animationDelay: '1s'}}></div>
                        <div className="absolute top-1/2 right-1/4 w-3 h-3 bg-purple-500/20 rounded-full animate-float" style={{animationDelay: '2s'}}></div>
                    </div>

                    {/* Navbar */}
                    <div className="glass-panel sticky top-0 z-50 border-b-0 border-b-[#30363d]">
                        <div className="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="bg-[#21262d] p-2 rounded-lg border border-[#30363d]">
                                    <Icons.BarChart2 />
                                </div>
                                <div>
                                    <h1 className="font-bold text-xl leading-none text-white tracking-tight">IB SEHS <span className="text-[#58a6ff]">Predictor</span></h1>
                                    <span className="text-xs text-[#8b949e] font-mono">Exam Strategy Database</span>
                                </div>
                            </div>
                            
                            <button 
                                onClick={handleExport}
                                className="flex items-center gap-2 bg-[#238636] hover:bg-[#2ea043] text-white px-4 py-2 rounded-md transition-all font-medium text-sm shadow-[0_0_15px_rgba(46,160,67,0.4)] border border-[rgba(240,246,252,0.1)]"
                            >
                                <Icons.Download />
                                Save & Export
                            </button>
                        </div>
                    </div>

                    <div className="relative z-10 max-w-6xl mx-auto px-4 py-8">
                        
                        {/* User Info Card */}
                        <div className="glass-panel rounded-xl p-6 mb-8 relative overflow-hidden group">
                             <div className="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                                <Icons.User />
                            </div>
                            <h2 className="text-lg font-semibold mb-4 text-[#58a6ff] flex items-center gap-2 font-mono">
                                <Icons.User /> Candidate Identity
                            </h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label className="block text-sm text-[#8b949e] mb-1 font-mono">Email Address (Hidden)</label>
                                    <div className="relative">
                                        <div className="absolute left-3 top-2.5 text-[#8b949e]"><Icons.Mail /></div>
                                        <input 
                                            type="email" 
                                            className="w-full bg-[#161b22] border border-[#30363d] rounded-md py-2 pl-10 pr-4 text-[#c9d1d9] focus:border-[#58a6ff] focus:outline-none transition-colors"
                                            placeholder="student@school.edu"
                                            value={userInfo.email}
                                            onChange={(e) => handleUserChange('email', e.target.value)}
                                        />
                                    </div>
                                    <p className="text-xs text-[#8b949e] mt-1 flex items-center gap-1 font-mono"><Icons.CheckSquare /> Encrypted locally</p>
                                </div>
                                <div>
                                    <label className="block text-sm text-[#8b949e] mb-1 font-mono">Username (Free Choice)</label>
                                    <div className="relative">
                                        <div className="absolute left-3 top-2.5 text-[#8b949e]"><Icons.User /></div>
                                        <input 
                                            type="text" 
                                            className="w-full bg-[#161b22] border border-[#30363d] rounded-md py-2 pl-10 pr-4 text-[#c9d1d9] focus:border-[#58a6ff] focus:outline-none transition-colors"
                                            placeholder="Create a username..."
                                            value={userInfo.username}
                                            onChange={(e) => handleUserChange('username', e.target.value)}
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Stats Summary */}
                        <div className="grid grid-cols-2 gap-4 mb-6">
                            <div className="glass-card p-4 rounded-lg relative overflow-hidden border-l-4 border-l-cyan-500">
                                <div className="z-10 relative">
                                    <span className="text-[#8b949e] text-xs font-mono block mb-1 uppercase tracking-wider">Total SL Predicted</span>
                                    <span className="text-3xl font-bold text-cyan-400 font-mono">{stats.slTotal}</span>
                                    <span className="text-xs text-[#8b949e] ml-2">(Paper 1A + Paper 2)</span>
                                </div>
                            </div>
                            <div className="glass-card p-4 rounded-lg relative overflow-hidden border-l-4 border-l-purple-500">
                                <div className="z-10 relative">
                                    <span className="text-[#8b949e] text-xs font-mono block mb-1 uppercase tracking-wider">Total HL Predicted</span>
                                    <span className="text-3xl font-bold text-purple-400 font-mono">{stats.hlTotal}</span>
                                    <span className="text-xs text-[#8b949e] ml-2">(Paper 1A + Paper 2)</span>
                                </div>
                            </div>
                        </div>

                        {/* Units List */}
                        <div className="space-y-1">
                            <div className="flex justify-between items-center mb-4 border-b border-[#30363d] pb-2">
                                <h2 className="text-xl font-bold text-white flex items-center gap-2">
                                    <Icons.BarChart2 /> Unit Database
                                </h2>
                                <button 
                                    onClick={() => setExpandedRow(expandedRow === 'all' ? null : 'all')}
                                    className="text-sm text-[#58a6ff] hover:underline font-mono"
                                >
                                    {expandedRow === 'all' ? 'Collapse All' : 'Expand All'}
                                </button>
                            </div>

                            {SEHS_DATA.map(unit => (
                                <UnitRow 
                                    key={unit.code}
                                    unit={unit}
                                    data={formData[unit.code]}
                                    onChange={handleUnitChange}
                                    isExpanded={expandedRow === 'all' || expandedRow === unit.code}
                                    onToggle={() => toggleRow(unit.code)}
                                />
                            ))}
                        </div>

                        {/* Footer */}
                        <div className="mt-12 text-center text-[#8b949e] text-xs font-mono pb-8 border-t border-[#30363d] pt-8">
                            <p>IB SEHS Exam Predictor • Antigravity Build v1.0</p>
                        </div>

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
